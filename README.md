# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

# Документация проекта Веб ларёк

### 1. Model

Описание: Модель отвечает за бизнес-логику и управление данными приложения. Она включает в себя работу с данными о товарах, пользователях и заказах.

### 2. View

Описание: Представление отвечает за отображение информации пользователю и взаимодействие с ним. Оно реализует пользовательский интерфейс и обрабатывает события, например, нажатия кнопок и ввод данных.

### 3. Presenter

Описание: Презентер связывает Model и View, обеспечивая взаимодействие между ними. Он получает данные от Model и обновляет View, а также обрабатывает действия пользователя.

## Типы и интерфейсы

### Categories

Тип, описывающий категории товаров. Возможные значения:

- `софт-скил`
- `другое`
- `дополнительное`
- `кнопка`
- `хард-скил`

### CategoryMapping

Сопоставление категорий с их строковыми представлениями. Ключи — это категории, а значения — строки, описывающие каждую категорию.

### ValidationErrors

Тип, представляющий ошибки валидации. Это частичное сопоставление полей формы заказа с сообщениями об ошибках. Ключи — это поля формы, а значения — строки с сообщениями об ошибках.

### PaymentMethod

Тип, описывающий доступные методы оплаты. Возможные значения:

- `card` (карта)
- `cash` (наличные)
- `other` (другие)

### PaymentMapping

Сопоставление методов оплаты с их строковыми представлениями. Ключи — это методы оплаты, а значения — строки, описывающие каждый метод.

### ApiResponse

Интерфейс, представляющий ответ API, содержащий массив элементов.

- `total`: общее количество элементов (число).
- `items`: массив элементов типа `Item`.

### ErrorResponse

Интерфейс для обработки ошибок API.

- `error`: сообщение об ошибке (строка).

### Action

Интерфейс для описания действия с обработчиком события клика.

- `onClick`: функция, принимающая объект события `MouseEvent` и выполняющая действие при клике.

### ApplicationStateInterface

Интерфейс, описывающий внутреннее состояние приложения. Содержит информацию о карточках, корзине, заказах и ошибках.

- `inventory`: массив товаров типа `Item`.
- `cart`: массив товаров в корзине типа `Item`.
- `orderInfo`: информация о заказе типа `OrderInterface`.
- `formValidationErrors`: ошибки валидации типа `ValidationErrors`.
- `getCartItemCount()`: метод, возвращающий количество товаров в корзине.
- `calculateTotalCartCost()`: метод, вычисляющий общую стоимость товаров в корзине.
- `addToCart(value: Item)`: метод для добавления товара в корзину.
- `removeFromCart(id: string)`: метод для удаления товара из корзины по ID.
- `clearCart()`: метод для очистки корзины.
- `updateOrderItems()`: метод для обновления ID товаров в заказе.
- `updateOrderField(field: keyof OrderFormInterface, value: string)`: метод для обновления полей заказа.
- `validateContactInfo()`: метод для проверки корректности контактной информации.
- `validateOrderInfo()`: метод для проверки корректности деталей заказа.
- `resetOrderInfo()`: метод для сброса информации о заказе после завершения покупки.
- `populateInventory(items: Item[])`: метод для преобразования данных с сервера в формат приложения.

### OrderFormInterface

Интерфейс для формы заказа.

- `email`: электронная почта пользователя (строка).
- `phone`: номер телефона пользователя (строка).
- `address`: адрес доставки (строка).
- `payment`: метод оплаты (тип `PaymentMethod`).

### OrderInterface

Интерфейс для описания заказа, расширяющий `OrderFormInterface`.

- `items`: массив идентификаторов купленных товаров (массив строк).
- `total`: общая стоимость заказа (число).

### OrderResponse

Интерфейс для успешного ответа при оформлении заказа.

- `id`: уникальный идентификатор заказа (строка).
- `total`: общая стоимость заказа (число).

### Item

Интерфейс для описания товара в магазине.

- `selected`: флаг, указывающий, выбран ли товар (булевый).
- `id`: уникальный идентификатор товара (строка).
- `title`: название товара (строка).
- `image`: ссылка на изображение товара (строка).
- `description`: описание товара (строка).
- `category`: категория товара (тип `Categories`).
- `price`: цена товара (число или null).

### PageInterface

Интерфейс для компонента страницы.

- `counter`: счетчик товаров в корзине (число).
- `gallery`: массив элементов типа `HTMLElement`, представляющих товары.
- `locked`: флаг, указывающий, заблокирована ли прокрутка страницы (булевый).

### ModalInterface

Интерфейс для компонента модального окна.

- `content`: содержимое модального окна (тип `HTMLElement`).

### CartInterface

Интерфейс для компонента корзины.

- `items`: массив идентификаторов товаров в корзине (массив строк).
- `total`: общая стоимость товаров в корзине (число).

### FormInterface

Интерфейс для формы.

- `valid`: флаг, указывающий, является ли форма валидной (булевый).
- `errors`: список ошибок валидации (строка).

### ExtendedFormInterface

Расширенный интерфейс для форм с более структурированной обработкой ошибок.

- `fieldErrors`: объект с ошибками по полям (тип `ValidationErrors`).
- `fieldValidity`: состояние валидации полей (объект с ключами строкового типа и булевыми значениями).

### CardInterface

Интерфейс для карточки товара.

- `id`: уникальный идентификатор карточки (строка).
- `title`: заголовок карточки (строка).
- `category`: категория карточки (строка).
- `description`: описание карточки (строка).
- `image`: URL или путь к изображению (строка).
- `price`: цена товара (число или null).
- `selected`: флаг, указывающий, выбрана ли карточка (булевый).

## Базовые элементы

## api.ts

ApiListResponse<Type>: Обобщенный тип для ответа API, содержащий общее количество элементов и массив элементов указанного типа.

- `total: number`: Общее количество элементов.
- `items: Type[]`: Массив элементов указанного типа.

ApiPostMethods: Перечисление доступных методов POST для запросов API.

- `POST`: Метод для создания нового ресурса.
- `PUT`: Метод для обновления существующего ресурса.
- `DELETE`: Метод для удаления ресурса.

### Классы

Api: Класс для взаимодействия с API, обеспечивающий методы для выполнения HTTP-запросов.

- Свойства:

  - `baseUrl: string`: Базовый URL для API, к которому будут добавляться конечные точки.
  - `options: RequestInit`: Настройки для HTTP-запросов, включая заголовки.

- Методы:
  - `constructor(baseUrl: string, options: RequestInit = {})`: Конструктор класса, принимающий базовый URL и опциональные настройки запроса.
  - `protected handleResponse(response: Response): Promise<object>`: Обрабатывает ответ от API, возвращая JSON-данные или отклоняя промис с сообщением об ошибке.
  - `get(uri: string)`: Выполняет GET-запрос по указанному URI и возвращает ответ от API.
  - `post(uri: string, data: object, method: ApiPostMethods = 'POST')`: Выполняет POST-запрос по указанному URI с переданными данными и методом, возвращая ответ от API.

## component.ts

### Component<T>

- Описание: Абстрактный базовый класс для создания компонентов, который предоставляет методы для работы с DOM-элементами.
- Параметры:
  - T - обобщенный тип, который позволяет компоненту работать с различными типами данных.
- Свойства:
  - container: HTMLElement - корневой элемент, в котором будет размещен компонент.

### Методы:

#### toggleClass(el: HTMLElement, className: string, force?: boolean):

- Описание: Переключает класс у указанного элемента.
- Параметры:
  - el: элемент, у которого будет переключаться класс.
  - className: имя класса для добавления или удаления.
  - force: (необязательный) булевое значение, указывающее, добавлять ли класс (true) или удалять (false).

#### setText(el: HTMLElement | null, value: string | null):

- Описание: Устанавливает текстовое содержимое элемента.
- Параметры:
  - el: элемент, текст которого будет установлен.
  - value: текстовое значение для установки.

#### setImage(el: HTMLImageElement | null, src: string | null):

- Описание: Устанавливает источник изображения для элемента.
- Параметры:
  - el: элемент изображения, которому будет установлен источник.
  - src: URL изображения.

#### setDisabled(el: HTMLButtonElement | null, disabled: boolean):

- Описание: Устанавливает состояние "disabled" для кнопки.
- Параметры:
  - el: элемент кнопки.
  - disabled: булевое значение, указывающее, должно ли состояние быть отключено.

#### setHidden(el: HTMLElement):

- Описание: Скрывает элемент, устанавливая стиль display в 'none'.
- Параметры:
  - el: элемент, который нужно скрыть.

#### setVisible(el: HTMLElement):

- Описание: Показывает элемент, убирая стиль display.
- Параметры:
  - el: элемент, который нужно показать.

#### render(data?: Partial<T>): HTMLElement:

- Описание: Обновляет данные компонента и возвращает корневой элемент.
- Параметры:
  - data: (необязательный) частичное обновление данных компонента.
    Возвращает: корневой DOM-элемент компонента.

### View<T>

- Описание: Класс, наследующий от Component, предназначенный для создания представлений с обработкой событий.

- Параметры:

T - обобщенный тип, аналогично классу Component.

- Свойства:

  - events: IEvents - интерфейс для работы с событиями, который позволяет управлять событиями в компоненте.
    Конструктор:

  - constructor(container: HTMLElement, events: IEvents):

- Параметры:
  - container: корневой элемент для компонента.
  - events: объект, реализующий интерфейс IEvents, для обработки событий.

### Типы

- T: Обобщенный тип, который используется для указания типа данных, с которыми будет работать компонент.

## View

## Общие элементы

## cart.ts

### Cart

- Описание:
  Класс Cart представляет собой компонент корзины, наследующий от базового класса View. Он реализует интерфейс CartInterface и отвечает за отображение товаров в корзине, управление общей суммой и обработку событий, связанных с оформлением заказа.

- Параметры конструктора

  - events: IEvents - объект, реализующий интерфейс для управления событиями. Используется для генерации событий, таких как открытие заказа.

- Свойства
  - static template: HTMLTemplateElement - шаблон для корзины, получаемый по ID элемента в DOM.
  - protected \_list: HTMLElement - элемент, в котором отображается список товаров в корзине.
  - protected \_total: HTMLElement - элемент, отображающий общую сумму товаров в корзине.
  - protected \_button: HTMLElement - кнопка для оформления заказа.

### Методы

#### constructor(events: IEvents)

- Инициализирует новый экземпляр класса Cart, клонируя шаблон корзины и устанавливая обработчик события на кнопку оформления заказа.

#### set items(items: HTMLElement[])

- Устанавливает список товаров в корзине.
- Параметры:
  - items: HTMLElement[] - массив элементов, представляющих товары.

#### set selected(items: string[])

- Устанавливает состояние выбора товаров.
- Параметры:
  - items: string[] - массив идентификаторов выбранных товаров.

#### set total(total: number)

- Устанавливает общую сумму товаров в корзине.
- Параметры:
  - total: number - общая сумма, которую необходимо отобразить.

#### Обработчики событий

- Кнопка оформления заказа:
  - При клике на кнопку генерируется событие order:open, которое может быть обработано в других частях приложения.

#### Обработка ошибок

- В случае отсутствия кнопки или элемента для отображения суммы, вызывается функция handleError, которая обрабатывает ошибки централизованно.

## form.ts

### Form<T>

- Описание:
  Класс Form<T> представляет собой компонент формы, который наследует от базового класса View<FormInterface>. Он предназначен для управления пользовательским вводом, валидацией и отправкой данных формы.

- Параметры конструктора

  - container: HTMLFormElement - элемент формы, в котором будут размещены поля ввода и кнопка отправки.
  - events: IEvents - объект, реализующий интерфейс для управления событиями, позволяющий генерировать и обрабатывать события, связанные с формой.

- Свойства
  - \_submit: HTMLButtonElement - кнопка отправки формы, которая будет активирована или деактивирована в зависимости от состояния валидации.
  - \_errors: HTMLElement - элемент, предназначенный для отображения ошибок валидации, если они возникают при вводе данных.
  - \_inputs: HTMLInputElement[] - массив полей ввода формы, которые будут отслеживаться для изменений и валидации.

### Методы

#### constructor:

- Инициализирует новый экземпляр класса, устанавливает обработчики событий для отслеживания изменений в полях ввода и отправки формы.

#### onInputChange(field: keyof T, value: string):

- Метод, который обрабатывает изменения в полях формы. При каждом изменении генерируется событие, содержащее имя поля и его новое значение.

#### set valid(value: boolean):

- Сеттер, который управляет состоянием кнопки отправки формы. Если значение true, кнопка становится активной; если false, кнопка отключается.

#### set errors(value: string):

- Сеттер, который обновляет текст ошибок валидации в соответствующем элементе. Если ошибки присутствуют, элемент отображается.

#### clearForm():

- Метод, который очищает все поля ввода формы и сбрасывает текст ошибок валидации.

#### checkRequiredFields():

- Метод, который проверяет наличие заполненных обязательных полей. Возвращает true, если все обязательные поля заполнены, и false в противном случае.

#### render(state: Partial<T> & FormInterface):

- Метод для рендеринга состояния формы. Обновляет состояние формы на основе переданных данных, включая состояние валидации и ошибки.

#### События

- ${this.container.name}:submit: Событие, которое излучается при отправке формы. Используется для обработки логики отправки данных в других частях приложения.
- ${this.container.name}.${String(field)}:change: Событие, которое излучается при изменении значения любого поля ввода. Содержит информацию о поле и его новом значении.

---

## modal.ts

### Классы

- Modal: Класс `Modal`, наследующий от `View<ModalInterface>`, отвечает за создание и управление модальными окнами на странице.

  - Свойства:

    - protected \_closeButton: HTMLButtonElement: Кнопка закрытия модального окна.
    - protected \_content: HTMLElement: Элемент, содержащий контент модального окна.

  - Методы:

    - constructor(container: HTMLElement, events: IEvents): Конструктор класса, инициализирующий элементы модального окна и добавляющий обработчики событий.

      - Параметры:
        - `container`: HTML-элемент, который служит контейнером для модального окна.
        - `events`: Интерфейс для управления событиями.

    - set content(value: HTMLElement): Сеттер для установки содержимого модального окна.

      - Параметры:
        - `value`: Новый HTML-элемент, который заменяет текущее содержимое модалки.

    - open(): Метод для открытия модального окна.

      - Описание: Добавляет класс для отображения модалки и генерирует событие открытия.

    - close(): Метод для закрытия модального окна.

      - Описание: Убирает класс отображения, очищает содержимое модалки и генерирует событие закрытия.

    - render(data: ModalInterface): HTMLElement: Метод для рендеринга модального окна.
      - Параметры:
        - `data`: Данные, необходимые для рендеринга модального окна.
      - Возвращает: Контейнер модального окна.

## success.ts

### Классы

- Success: Класс `Success`, наследующий от `Component<OrderResponse>`, отвечает за отображение информации об успешном заказе.

  - Свойства:

    - protected \_total: HTMLElement: Элемент для отображения общей суммы заказа.
    - protected \_close: HTMLButtonElement: Кнопка закрытия окна с информацией о заказе.

  - Методы:

    - constructor(container: HTMLFormElement, actions?: Action): Конструктор класса, инициализирующий элементы для отображения информации о заказе и добавляющий обработчики событий.

      - Параметры:
        - `container`: HTML-форма, которая служит контейнером для отображения информации.
        - `actions`: Объект действий, содержащий обработчик события нажатия на кнопку закрытия.

    - set total(value: number): Сеттер для свойства `total`, который обновляет текст общей суммы заказа.
      - Параметры:
        - `value`: Числовое значение, представляющее общую сумму заказа.
      - Описание: Устанавливает текст с информацией о списанной сумме синапсов.

## Специфичные элементы

## card.ts

### Классы

- Card: Базовый класс `Card`, представляющий карточку товара.

  - Свойства:

    - protected \_title: HTMLElement: Элемент заголовка карточки.
    - protected \_image: HTMLImageElement: Элемент изображения карточки.
    - protected \_category: HTMLElement: Элемент категории карточки.
    - protected \_price: HTMLElement: Элемент цены карточки.
    - protected \_button: HTMLButtonElement: Элемент кнопки карточки.

  - Методы:

    - constructor(blockName: string, container: HTMLElement, action?: Action): Конструктор класса, инициализирующий элементы карточки и добавляющий обработчики событий.

      - Параметры:
        - `blockName`: Имя блока для CSS классов.
        - `container`: Контейнер, в котором находится карточка.
        - `action`: Объект действий, содержащий обработчик события клика.

    - set id(value: string): Сеттер для установки `id` карточки в data-атрибут контейнера.
    - get id(): string: Геттер для получения `id` карточки из data-атрибута.

    - set title(value: string): Сеттер для установки текста заголовка карточки.
    - get title(): string: Геттер для получения текста заголовка карточки.

    - set image(value: string): Сеттер для установки источника изображения карточки.
    - set button(value: string): Сеттер для изменения текста кнопки карточки.
    - set selected(value: boolean): Сеттер для установки состояния выбора карточки (активна/неактивна).
    - set price(value: number | null): Сеттер для установки цены карточки и изменения состояния кнопки.
    - set category(value: Categories): Сеттер для установки текста и классов категории карточки.

- Product: Класс `Product`, наследующий от `Card`, представляющий товар.

  - Конструктор:
    - constructor(container: HTMLElement, action?: Action): Вызов конструктора родительского класса с именем блока 'card'.

- ProductPreview: Класс `ProductPreview`, наследующий от `Card`, представляющий предварительный просмотр товара.

  - Свойства:

    - protected \_description: HTMLElement: Элемент описания карточки.

  - Методы:
    - constructor(container: HTMLElement, action?: Action): Вызов конструктора родительского класса и инициализация элемента описания.
    - set description(value: string): Сеттер для установки текста описания карточки.

## orderForm.ts

### Класс OrderForm

Класс `OrderForm` представляет собой форму заказа, позволяя пользователям выбирать способ оплаты (картой или наличными).

- Свойства:

  - protected \_card: HTMLButtonElement: Кнопка для оплаты картой.
  - protected \_cash: HTMLButtonElement: Кнопка для оплаты наличными.

- Методы:

  - constructor(blockName: string, container: HTMLFormElement, events: IEvents): Конструктор класса, инициализирующий кнопки оплаты и устанавливающий обработчики событий.

    - Параметры:
      - `blockName`: Имя блока для использования в CSS.
      - `container`: Контейнер, в котором находится форма заказа.
      - `events`: Объект событий, связанных с формой.

  - private initPaymentButtons(): Метод для инициализации кнопок оплаты с добавлением обработчиков событий для каждой кнопки.

  - private setupButton(button: HTMLButtonElement, paymentType: string): Метод для настройки кнопки оплаты.

    - Параметры:
      - `button`: Кнопка, которую нужно настроить.
      - `paymentType`: Тип платежа (например, 'cash' или 'card').

  - private toggleActiveButton(activeButton: string): Метод для управления активным состоянием кнопок.

    - Параметры:
      - `activeButton`: Тип активной кнопки.

  - disableButtons(): Метод для отключения активных состояний кнопок, сбрасывающий активное состояние для обеих кнопок.

## page.ts

### Класс Page

Класс `Page` расширяет функциональность базового класса `View`, предоставляя структуру для страницы с элементами управления и отображения.

- Свойства:

  - protected \_counter: HTMLElement: Элемент для отображения количества товаров в корзине.
  - protected \_gallery: HTMLElement: Элемент для отображения галереи товаров.
  - protected \_wrapper: HTMLElement: Обертка для всей страницы.
  - protected \_cart: HTMLElement: Элемент, представляющий корзину покупок.

- Методы:

  - constructor(container: HTMLElement, events: IEvents): Конструктор класса, инициализирующий элементы страницы и устанавливающий обработчик события для открытия корзины.

    - Параметры:
      - `container`: Контейнер, в котором находится страница.
      - `events`: Объект для управления событиями.

  - set counter(value: number): Сеттер для обновления счётчика товаров в корзине, устанавливающий текст счётчика.

  - set gallery(items: HTMLElement[]): Сеттер для обновления карточек товаров в галерее, заменяющий содержимое галереи на новые карточки.

  - set locked(value: boolean): Сеттер для управления блокировкой прокрутки страницы. Добавляет или удаляет класс для блокировки прокрутки в зависимости от значения.

## userInfo.ts

### Класс UserInfo

Класс `User Info` наследует от базового класса `Form` и реализует интерфейс `OrderFormInterface`, предоставляя функциональность для управления формой заказа.

- Конструктор:

  - constructor(container: HTMLFormElement, events: IEvents): Конструктор класса, инициализирующий контейнер формы и события.
    - Параметры:
      - `container`: HTML-элемент формы, содержащий поля ввода.
      - `events`: Объект для управления событиями.

- Методы:

  - set email(value: string): Сеттер для обновления значения поля email. Находит элемент ввода по имени и устанавливает его значение. Если элемент не найден, вызывается функция обработки ошибок.

  - set phone(value: string): Сеттер для обновления значения поля phone. Аналогично, находит элемент ввода и устанавливает его значение, обрабатывая ошибки в случае отсутствия элемента.

## Model

## ApplicationState.ts

### Класс ApplicationState

Класс `ApplicationState` реализует интерфейс `ApplicationStateInterface` и управляет состоянием приложения, включая товары, корзину и информацию о заказе.

- Свойства:

  - inventory: Item[]: Массив товаров, доступных для покупки.
  - cart: Item[]: Массив товаров, добавленных в корзину.
  - orderInfo: OrderInterface: Объект с информацией о заказе, включая email, телефон, адрес, метод оплаты, список ID товаров и общую стоимость.
  - formValidationErrors: ValidationErrors: Объект для хранения ошибок валидации формы.

- Методы:

  - getCartItemCount(): number: Возвращает количество товаров в корзине.

  - calculateTotalCartCost(): number: Вычисляет общую стоимость товаров в корзине.

  - addToCart(value: Item): void: Добавляет товар в корзину.

  - removeFromCart(id: string): void: Удаляет товар из корзины по ID.

  - clearCart(): void: Очищает корзину полностью.

  - setOrderItems(): void: Добавляет ID товаров в поле `items` для `orderInfo` и обновляет общую стоимость заказа.

  - updateOrderField(field: keyof OrderFormInterface, value: string): void: Обновляет поля `email`, `phone`, `address` и `payment` в `orderInfo`, включая валидацию метода оплаты.

  - validateContactInfo(): boolean: Проверяет корректность контактной информации и возвращает результат валидации.

  - validateOrderInfo(): boolean: Проверяет корректность деталей заказа, вызывая метод `validateContactInfo`.

  - resetOrderInfo(): boolean: Сбрасывает `orderInfo` после завершения покупки и очищает корзину.

  - populateInventory(items: Item[]): void: Заполняет массив `inventory` данными товаров, полученными с сервера.

  - resetSelection(): void: Сбрасывает поле `isSelected` у всех товаров после покупки.

## Presenter

## index.ts

### Основной файл приложения

Этот файл отвечает за инициализацию приложения, обработку событий и взаимодействие с API. Он связывает различные компоненты, такие как страницы, корзина и форма заказа, обеспечивая их функциональность и взаимодействие.

#### Импорт необходимых модулей и компонентов

- ApplicationApi: Модуль для работы с API.
- EventEmitter: Модуль для управления событиями.
- Page: Компонент страницы.
- Modal: Компонент модального окна.
- Card, Product, ProductPreview: Компоненты карточки товара.
- ApplicationState: Управление состоянием приложения.
- Утилиты: Функции для работы с элементами и шаблонами.
- Типы данных: Определения для API и заказов.
- Константы: URL для API и CDN.
- Стили: Импорт стилей приложения.
- Компоненты: Корзина, форма заказа, информация о пользователе и успешное завершение.

#### Создание экземпляров необходимых классов

- `applicationApi`: Экземпляр класса `ApplicationApi`, который используется для выполнения запросов к API и получения данных о товарах.
- `events`: Экземпляр класса `EventEmitter`, который управляет событиями в приложении.
- `cartHandler`: Экземпляр класса `CartHandler`, который управляет состоянием корзины и взаимодействует с событиями.

#### Получение шаблонов из HTML документа

Шаблоны карточек, корзины и форм заказа загружаются из HTML-документа для дальнейшего использования.

#### Обработчики событий

- `events.on('modal:open', ...)`: Блокирует страницу при открытии модального окна.
- `events.on('modal:close', ...)`: Разблокирует страницу при закрытии модального окна.
- `events.on('card:select', (item: Item) => {...})`: Устанавливает выбранный товар в качестве предварительного просмотра в корзине.
- `events.on('items:change', (items: Item[]) => {...})`: Обновляет отображение карточек товаров в зависимости от содержимого корзины.
- `events.on('preview:change', (item: Item) => {...})`: Обновляет состояние кнопки в зависимости от того, находится ли товар в корзине.

#### Обработка события открытия корзины и формы заказа

- `events.on('basket:open', ...)`: Отображает содержимое корзины в модальном окне.
- `events.on('order:open', ...)`: Отображает форму заказа в модальном окне с начальными параметрами.

#### Обработка отправки заказа

- `events.on('order:submit', ...)`: Отображает модальное окно с контактной информацией перед отправкой заказа.
- `events.on('contacts:submit', async () => {...})`: Отправляет заказ с информацией из корзины. Обрабатывает успешное завершение и ошибки.

### Описание переменных, классов и методов

#### Переменные

- `applicationApi`:

  - Тип: `ApplicationApi`
  - Описание: Экземпляр для работы с API, осуществляющий запросы и получающий данные о товарах.

- `events`:

  - Тип: `EventEmitter`
  - Описание: Объект для управления событиями в приложении, позволяющий подписываться на события и их обработку.

- `cartHandler`:
  - Тип: `CartHandler`
  - Описание: Управляет состоянием корзины, добавляет и удаляет товары, а также обновляет информацию о заказе.

#### Классы

- `ApplicationApi`: Класс для работы с API, включает методы для получения данных о товарах и отправки заказов.
- `EventEmitter`: Класс для управления событиями, предоставляет методы для подписки и эмитирования событий.
- `CartHandler`: Класс, управляющий состоянием корзины, предоставляет методы для добавления, удаления товаров и обновления информации о заказе.
- `Page`: Класс, представляющий страницу приложения, управляет отображением и состоянием страницы.
- `Modal`: Класс для работы с модальными окнами, позволяет открывать и закрывать окна с контентом.
- `Card`: Класс для отображения карточек товаров, включает методы для рендеринга и обработки событий
- `Product`: Класс, представляющий отдельный товар, включает свойства, такие как название, цена и описание, а также методы для получения информации о товаре и его обновления.
- `ProductPreview`: Класс для отображения предварительного просмотра товара, включает методы для управления отображением информации о товаре и его взаимодействия с корзиной.
- `ApplicationState`: Класс для управления состоянием всего приложения, включает методы для сохранения и извлечения состояния, а также для обработки изменений состояния при взаимодействии с пользователем.
- `Utils`: Набор утилитарных функций для работы с элементами DOM, форматированием данных и другими общими задачами, которые могут использоваться в различных частях приложения.

## Утилиты

## ApplicationApi.ts

## ApplicationApi

### Описание

`ApplicationApi` — это класс, который наследуется от базового класса `Api` и предназначен для работы с API приложения. Он включает методы для получения списка продуктов, получения конкретного продукта по его ID и оформления заказов. Класс также управляет формированием полных URL для изображений товаров, используя базовый URL для CDN.

### Свойства

- `cdn: string`: Переменная для хранения базового URL для изображений товаров.

### Конструктор

- Параметры:
  - `cdn`: URL для CDN, который будет использоваться для формирования полных путей к изображениям.
  - `baseUrl`: Базовый URL API, который будет использоваться для выполнения запросов.
  - `options`: Опциональные параметры для настройки запросов.

### Методы

- `getProductList()`: Выполняет GET-запрос к API для получения списка продуктов и возвращает массив объектов с данными о товарах.

- `getProductItem(id: string)`: Выполняет GET-запрос к API для получения конкретного продукта по его ID и возвращает объект с данными о товаре.

- `orderProducts(order: OrderInterface)`: Выполняет POST-запрос к API для оформления заказа продуктов и возвращает результат оформления заказа.

## utils.ts

### Описание

Этот модуль содержит функции и типы, которые помогают в работе с DOM-элементами, валидацией данных и обработкой ошибок. Он включает функции для преобразования строк, проверки типов, создания элементов и работы с атрибутами `data-`.

### Функции

- `pascalToKebab(value: string): string`: Преобразует строку из формата PascalCase в формат kebab-case.
- `isSelector(x: any): x is string`: Проверяет, является ли переданное значение строкой и имеет ли длину больше 1.
- `isEmpty(value: any): boolean`: Проверяет, является ли значение `null` или `undefined`.
- `ensureAllElements<T extends HTMLElement>(selectorElement: SelectorCollection<T>, context?: HTMLElement): T[]`: Возвращает массив элементов, соответствующих селектору, из указанного контекста.
- `ensureElement<T extends HTMLElement>(selectorElement: SelectorElement<T>, context?: HTMLElement): T`: Убедитесь, что селектор указывает на единственный элемент, выбрасывает ошибку, если элемент не найден или найдено несколько.
- `cloneTemplate<T extends HTMLElement>(query: string | HTMLTemplateElement): T`: Клонирует содержимое указанного шаблона.
- `bem(block: string, element?: string, modifier?: string): { name: string; class: string }`: Генерирует имена классов в формате BEM (Block Element Modifier).
- `getObjectProperties(obj: object, filter?: (name: string, prop: PropertyDescriptor) => boolean): string[]`: Возвращает список свойств объекта, с возможностью фильтрации.
- `setElementData<T extends Record<string, unknown> | object>(el: HTMLElement, data: T)`: Устанавливает атрибуты `data-` для указанного элемента.
- `getElementData<T extends Record<string, unknown>>(el: HTMLElement, scheme: Record<string, Function>): T`: Получает данные из атрибутов `data-` элемента и преобразует их по заданной схеме.
- `isPlainObject(obj: unknown): obj is object`: Проверяет, является ли объект простым объектом.
- `isBoolean(v: unknown): v is boolean`: Проверяет, является ли значение булевым.
- `createElement<T extends HTMLElement>(tagName: keyof HTMLElementTagNameMap, props?: Partial<Record<keyof T, string | boolean | object>>, children?: HTMLElement | HTMLElement[]): T`: Создает новый элемент DOM с указанными свойствами и дочерними элементами.
- `handlePrice(price: number): string`: Форматирует цену, добавляя пробелы каждые три цифры.
- `handleError(errorMessage: string): void`: Логирует сообщение об ошибке в консоль.

## constants.ts

### Описание

Этот модуль содержит константы для базового URL API и URL контента, а также объекты для сопоставления категорий и методов оплаты. Он использует типы `CategoryMapping` и `PaymentMapping`, импортированные из файла `../types`.

### Константы

- `API_URL`: Базовый URL API, формируемый из переменной окружения `API_ORIGIN`. Используется для взаимодействия с API.
- `CDN_URL`: URL контента, также формируемый из переменной окружения `API_ORIGIN`. Используется для доступа к статическому контенту.

### Сопоставления

- `categoryMapping: CategoryMapping`: Объект, который сопоставляет категории с соответствующими CSS классами:

  - `'софт-скил'`: `'card__category_soft'`
  - `'другое'`: `'card__category_other'`
  - `'дополнительное'`: `'card__category_additional'`
  - `'кнопка'`: `'card__category_button'`
  - `'хард-скил'`: `'card__category_hard'`

- `paymentMapping: PaymentMapping`: Объект, который сопоставляет методы оплаты с текстовыми значениями:
  - `'card'`: `'Онлайн'`
  - `'cash'`: `'При получении'`
  - `'other'`: `'По-другому ¯\\_( ͡° ͜ʖ ͡°)_/¯'`
